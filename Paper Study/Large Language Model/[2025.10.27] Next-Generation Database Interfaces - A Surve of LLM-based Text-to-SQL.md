
## 목차

* [1. LLM-based Text-to-SQL 개요](#1-llm-based-text-to-sql-개요)
  * [1-1. Text-to-SQL의 기술적 발전 과제](#1-1-text-to-sql의-기술적-발전-과제)
  * [1-2. Text-to-SQL 시스템의 진화 과정](#1-2-text-to-sql-시스템의-진화-과정)
* [2. 벤치마크 데이터셋 및 평가](#2-벤치마크-데이터셋-및-평가)
  * [2-1. 데이터셋](#2-1-데이터셋)
  * [2-2. 평가 Metric](#2-2-평가-metric)
* [3. 상세 방법론](#3-상세-방법론)
  * [3-1. In-context Learning](#3-1-in-context-learning) 
  * [3-2. Fine-Tuning](#3-2-fine-tuning)
* [4. 논의 사항](#4-논의-사항)
  * [4-1. LLM 기반 방법 vs. 전통적 방법](#4-1-llm-기반-방법-vs-전통적-방법)
  * [4-2. LLM 기반 방법 간 비교](#4-2-llm-기반-방법-간-비교)
  * [4-3. 실제 적용 시의 Robustness](#4-3-실제-적용-시의-robustness)
  * [4-4. 데이터 보안 및 해석 가능성](#4-4-데이터-보안-및-해석-가능성)

## 논문 소개

* Zijin Hong and Zheng Yuan et al., "Next-Generation Database Interfaces: A Survey of LLM-based Text-to-SQL", 2024
* [arXiv Link](https://arxiv.org/pdf/2406.08426)

## 1. LLM-based Text-to-SQL 개요

* **Text-to-SQL** 은 자연어를 DB에서 많이 사용하는 SQL 쿼리문으로 바꾸는 NLP 분야이다.
* **LLM-based Text-to-SQL** 은 이를 LLM 기반으로 해결하는 것이다. 

**LLM-based Text-to-SQL 방법론의 분류**

![image](../images/LLM_Text_to_SQL_1.PNG)

[(출처)](https://arxiv.org/pdf/2406.08426) : Zijin Hong and Zheng Yuan et al., "Next-Generation Database Interfaces: A Survey of LLM-based Text-to-SQL"

### 1-1. Text-to-SQL의 기술적 발전 과제

Text-to-SQL의 기술적 발전 과제는 다음과 같다.

| 발전 과제                       | 설명                                                                                                                             |
|-----------------------------|--------------------------------------------------------------------------------------------------------------------------------|
| 언어적 복잡성 및 애매모호함             | - 자연어로 된 질문은 **복잡한 언어적 표현을 포함** 하기도 한다.<br>- 이러한 언어적 표현을 **SQL로 정확히 mapping 시키는 것** 은 어려울 수 있다.                                |
| 스키마 이해 및 표현                 | - 정확한 SQL 쿼리 생성을 위해, Text-to-SQL 시스템은 **데이터베이스 스키마를 정확하고 완벽히 이해** 해야 한다.                                                       |
| 드물거나 복잡한 SQL 연산             | - 가끔 어떤 SQL 쿼리는 **드물거나 복잡한 연산 syntax 를 포함** 할 수 있다. (nested sub-query 등)<br>- 이러한 연산이 있는 데이터는 **학습 데이터에 별로 없을** 수 있다.          |
| Cross-Domain Generalization | - text-to-SQL 시스템은 **다양한 데이터베이스 검색 시나리오** 에 일반화하여 적용하기 어려울 수 있다.<br>- **특정 도메인에 최적화** 하여 학습된 모델은 다른 도메인에서 성능을 잘 발휘하지 못할 수도 있다. |

### 1-2. Text-to-SQL 시스템의 진화 과정

Text-to-SQL 시스템의 진화 과정은 다음과 같다.

| 진화 단계                         | 설명                                                                                                                                                          |
|-------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Rule-based** methods        | text-to-SQL 시스템의 초기 단계<br>- 사람이 직접 휴리스틱하게 규칙을 구성<br>- **언어적으로 복잡한 자연어 쿼리** 를 해석하는 데 한계                                                                      |
| **Deep Learning-based** 접근 방법 | 다음 기술 적용<br>- Sequence-to-sequence 모델<br>- Encoder-Decoder 기반 모델                                                                                            |
| **PLM-based** 구현              | **PLM (Pre-trained Language Model)** 기반 방법<br>- BERT, RoBERTa 등을 표준 text-to-SQL 데이터셋에 적용하여 Fine-Tuning 시도<br>- 딥러닝 기반 방법보다 정확도가 높지만, **복잡한 연산에서 여전히 오류 발생** |
| **LLM-based** 구현              | GPT와 같은 거대 언어 모델 (LLM) 을 이용<br>- 현재 활발히 연구되고 있는 분야 중 하나<br>- LLM의 지식 및 추론 능력을 SQL 해석에 이용하려는 여러 시도들이 있음                                                      |

## 2. 벤치마크 데이터셋 및 평가

### 2-1. 데이터셋

* 벤치마크 데이터셋 목록

![image](../images/LLM_Text_to_SQL_2.PNG)

[(출처)](https://arxiv.org/pdf/2406.08426) : Zijin Hong and Zheng Yuan et al., "Next-Generation Database Interfaces: A Survey of LLM-based Text-to-SQL"

* 벤치마크 데이터셋 분류

| 데이터셋 분류                  | 설명                                                                                                                                              |
|--------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| Cross-Domain 데이터셋        | 다양한 도메인의 서로 다른 DB의 배경 지식을 포함한 데이터셋                                                                                                              |
| Knowledge-Augmented 데이터셋 | **특정 도메인에 특화된 지식** 이 결합된 데이터셋 (domain knowledge 등)<br>- BIRD, Spider-DK, SQUALL 등                                                               |
| Context-Dependent 데이터셋   | 하나의 예시에 대해 **1개의 질문이 1개의 SQL 쿼리와 대응되는** 데이터만 포함 (SParC, CoSQL 등)<br>- Spider 데이터셋의 자연어 질문을 **여러 개의 sub-question 과 sub-SQL 로 분해** (Spider SS&CG) |
| Robustness 데이터셋          | 오염된 데이터베이스에서의 text-to-SQL 성능 평가<br>- Spider-SYN, ADVETA 등                                                                                       |
| Cross-lingual 데이터셋       | **여러 개의 언어** 로 구성된 text-to-SQL 데이터셋<br>- 영어로 된 데이터베이스 내용을 검색하기 위한 중국어 자연어 질의 등을 예시로 들 수 있음<br>- DuSQL 등                                         |
| Long-context 데이터셋        | **자연어를 복잡한 SQL 쿼리로 변환** 하는 능력을 평가하는 데이터셋<br>- 일부 SQL 쿼리는 **100개 이상의 토큰** 으로 구성되어 있는 경우가 있음<br>- Spider 2.0 등                                    |
| Specialized-domain 데이터셋  | 특정 domain-specific 한 데이터셋의 경우, **우수한 text-to-SQL 성능의 모델도 부족함이 있을 수 있음**<br>- BULL 의 경우, 금융 분야에서 이런 점을 극복하기 위한 벤치마크 데이터셋임                        |

### 2-2. 평가 Metric

## 3. 상세 방법론

### 3-1. In-context Learning

### 3-2. Fine-Tuning

## 4. 논의 사항

### 4-1. LLM 기반 방법 vs. 전통적 방법

### 4-2. LLM 기반 방법 간 비교

### 4-3. 실제 적용 시의 Robustness

### 4-4. 데이터 보안 및 해석 가능성
