## ëª©ì°¨

* [1. Generative Representation](#1-generative-representation)
  * [1-1. Multi-level Semantics](#1-1-multi-level-semantics)
  * [1-2. Layer-wise Generative Representations](#1-2-layer-wise-generative-representations)
* [2. Label ì„ ë‚˜íƒ€ë‚´ëŠ” ë²¡í„° (Emergent Variation Factors) ì°¾ê¸°](#2-label-ì„-ë‚˜íƒ€ë‚´ëŠ”-ë²¡í„°-emergent-variation-factors-ì°¾ê¸°)
  * [2-1. Latent Space ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŒ (Probing)](#2-1-latent-space-ì—ì„œ-ì°¾ì„-ìˆ˜-ìˆìŒ-probing)
  * [2-2. Label ì„ ë‚˜íƒ€ë‚´ëŠ” Vector ê³„ì‚°](#2-2-label-ì„-ë‚˜íƒ€ë‚´ëŠ”-vector-ê³„ì‚°)
  * [2-3. í•´ë‹¹ Vector ë¥¼ ì´ìš©í•œ Label ê°’ ë³€ê²½](#2-3-í•´ë‹¹-vector-ë¥¼-ì´ìš©í•œ-label-ê°’-ë³€ê²½)
* [3. ì‹¤í—˜ ì„¤ì • ë° ê²°ê³¼](#3-ì‹¤í—˜-ì„¤ì •-ë°-ê²°ê³¼)
  * [3-1. ì‹¤í—˜ ì„¤ì •](#3-1-ì‹¤í—˜-ì„¤ì •)
  * [3-2. ì‹¤í—˜ ê²°ê³¼](#3-2-ì‹¤í—˜-ê²°ê³¼)

## ë…¼ë¬¸ ì†Œê°œ

* Ceyuan Yang, Yujun Shen et al., "Semantic Hierarchy Emerges in Deep Generative Representations for Scene Synthesis", 2019
* [arXiv Link](https://arxiv.org/pdf/1911.09267)

## 1. Generative Representation

* GAN ì—­ì‹œ ì‚¬ëŒì²˜ëŸ¼ **ê° ë ˆì´ì–´ë¥¼ í†µí•´ ë‹¨ê³„ì ì¸ ê³¼ì •ì„ ê±°ì³** ì´ë¯¸ì§€ë¥¼ ìƒì„±í•œë‹¤.
  * ì˜ˆë¥¼ ë“¤ì–´, Generator Network ì˜ ì¤‘ê°„ì— í•´ë‹¹í•˜ëŠ” ë ˆì´ì–´ì—ì„œ **category ì— ë§ëŠ” object** ë¥¼ ìƒì„±í•œë‹¤.

### 1-1. Multi-level Semantics

* ì£¼ì–´ì§„ ì´ë¯¸ì§€ì— ëŒ€í•´ì„œ ë‹¤ìŒê³¼ ê°™ì´ **ì—¬ëŸ¬ ë‹¨ê³„ì˜ Attribute** ë¥¼ ìƒê°í•  ìˆ˜ ìˆë‹¤.
* ì´ì™€ ê°™ì´ GAN ì—­ì‹œ **ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ end-to-end ë°©ì‹ìœ¼ë¡œ í•™ìŠµ** í•œë‹¤.

![image](../images/StyleGANVectorFind_1.PNG)

[(ì¶œì²˜)](https://arxiv.org/pdf/2012.09036) : Ceyuan Yang, Yujun Shen et al., "Semantic Hierarchy Emerges in Deep Generative Representations for Scene Synthesis"

### 1-2. Layer-wise Generative Representations

* ì‚¬ëŒì´ ê·¸ë¦¼ì„ ê·¸ë¦´ ë•Œì²˜ëŸ¼, **GAN ì—­ì‹œ Multi-level abstraction hierarchy** ë¥¼ ì´ìš©í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•œë‹¤.
* ì¦‰, GANì€ ë‹¤ìŒê³¼ ê°™ì´ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•œë‹¤.

| ë‹¨ê³„           | ì´ë¯¸ì§€ ìƒì„±                           |
|--------------|----------------------------------|
| Early Stage  | ëŒ€ëµì ì¸ ë ˆì´ì•„ì›ƒ (spatial layout) ìƒì„±    |
| Middle Stage | **íŠ¹ì • category ì— í•´ë‹¹í•˜ëŠ” object** ìƒì„± |
| Later Stage  | ì´ë¯¸ì§€ì˜ ì„¸ë¶€ì ì¸ ë¶€ë¶„ ë° ìƒ‰ìƒ ë“±ì„ ë Œë”ë§í•˜ë“¯ì´ ìƒì„±   |

## 2. Label ì„ ë‚˜íƒ€ë‚´ëŠ” ë²¡í„° (Emergent Variation Factors) ì°¾ê¸°

* ì—¬ê¸°ì„œëŠ” **Label (Condition) ì„ ë‚˜íƒ€ë‚´ëŠ” ë²¡í„° (Emergent Variation Factors)**, ì¦‰ **ì´ë¯¸ì§€ í˜•íƒœëŠ” ê·¸ëŒ€ë¡œ ë‘ê³ , Label (Condition) ì— í•´ë‹¹í•˜ëŠ” ë¶€ë¶„ë§Œì„ ì¡°ì •** í•˜ê¸° ìœ„í•œ ë²¡í„°ë¥¼ ì°¾ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³¸ë‹¤.
  * í•´ë‹¹ ë²¡í„°ë¥¼ latent vector $z$ ì— (ê²½ìš°ì— ë”°ë¼ ê°€ì¤‘ì¹˜ë¥¼ ì ìš©í•˜ì—¬) ë”í•˜ê±°ë‚˜ ëºŒìœ¼ë¡œì¨, **Label (Condition) ì— í•´ë‹¹í•˜ëŠ” ë¶€ë¶„ë§Œì„ ì¡°ì •** í•  ìˆ˜ ìˆë‹¤.
* Label (Condition) ì€ [Oh-LoRA ğŸ‘±â€â™€ï¸ (ì˜¤ë¡œë¼) ì´ˆê¸° í”„ë¡œì íŠ¸ (25.04.08 - 25.04.25)](https://github.com/WannaBeSuperteur/AI_Projects/tree/main/2025_04_08_OhLoRA) ì—ì„œì˜ ```eyes (ëˆˆì„ ëœ¬ ì •ë„)```, ```mouth (ì…ì„ ë²Œë¦° ì •ë„)```, ```pose (ê³ ê°œ ëŒë¦¼)``` ë“±ì˜ **í•µì‹¬ ì†ì„± ê°’** ì— í•´ë‹¹í•œë‹¤.

### 2-1. Latent Space ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŒ (Probing)

**1. í•µì‹¬ ì•„ì´ë””ì–´**

* Label (Condition) ì„ ë‚˜íƒ€ë‚´ëŠ” ë²¡í„°ëŠ” ë‹¤ìŒê³¼ ê°™ì´ **Latent Space ë¡œë¶€í„° ì°¾ì•„ë‚¼ ìˆ˜ ìˆë‹¤.**
* ê³¼ì • ìš”ì•½
  * ë¨¼ì €, latent space $Z$ ë¡œë¶€í„° **Classifier $F$** ë¥¼ ì´ìš©í•˜ì—¬ **Semantic Information** ì„ ì–»ëŠ”ë‹¤.
  * **ì´ì§„ ë¶„ë¥˜** ë¬¸ì œì²˜ëŸ¼ ê°„ì£¼í•˜ì—¬, í•´ë‹¹ semantic information ì— ëŒ€í•œ **Decision Boundary** ë¥¼ ì°¾ëŠ”ë‹¤.
  * í•´ë‹¹ Decision Boundary ì™€ ìˆ˜ì§ì¸ ë²¡í„° $n_i$ ì¤‘ **$F$ ì˜ ì¶œë ¥ê°’ì— ê°€ì¥ í¬ê²Œ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”** ê²ƒì„ ìµœì¢… ì±„íƒí•œë‹¤.

![image](../images/StyleGANVectorFind_2.PNG)

[(ì¶œì²˜)](https://arxiv.org/pdf/2012.09036) : Ceyuan Yang, Yujun Shen et al., "Semantic Hierarchy Emerges in Deep Generative Representations for Scene Synthesis"

**2. Latent Space ì—ì„œ Label (Condition) ë²¡í„° ì°¾ê¸°**

* Latent Space $Z$ ë¡œë¶€í„° Semantic Information ì°¾ê¸°
  * GAN ì— ì˜í•´ ìƒì„±ëœ ì´ë¯¸ì§€ $x = G(z)$ ë¥¼ ì´ìš©í•œë‹¤.
  * (ê²½ìš°ì— ë”°ë¼ Pre-train ëœ) Image Classifier ë¥¼ ì´ìš©í•˜ì—¬, ê° **latent code $z \in Z$** ì— ëŒ€í•´ **Semantic Score ë¥¼ mapping** ì‹œí‚¨ë‹¤.
* Semantic Information ì— ëŒ€í•œ Decision Boundary ì°¾ê¸°
  * Semantic space $S$ ì— ëŒ€í•´, ìœ„ ê³¼ì •ì„ í†µí•´ ì–»ì€ $Z â†’ S$ ë¡œì˜ **one-by-one mapping** ì„ ì´ìš©í•œë‹¤.
  * ì´ mapping ì„ ì´ìš©í•˜ì—¬, í•´ë‹¹ Semantic information ì— ëŒ€í•œ **Decision Boundary (ì´ì§„ ë¶„ë¥˜ ë¬¸ì œë¡œ ê°„ì£¼í•˜ì—¬ ì–»ì€)** ë¥¼ ì–»ëŠ”ë‹¤.

### 2-2. Label ì„ ë‚˜íƒ€ë‚´ëŠ” Vector ê³„ì‚°

**1. í•µì‹¬ ì•„ì´ë””ì–´**

* [Latent Space ì—ì„œ ì°¾ì€ Decision Boundary ë²¡í„°](#2-1-latent-space-ì—ì„œ-ì°¾ì„-ìˆ˜-ìˆìŒ-probing) ì™€ ìˆ˜ì§ì¸ ë²¡í„°, ì¦‰ $n$ ì€ **ì—¬ëŸ¬ ê°œê°€ ìˆë‹¤.**
* ì´ ì¤‘ ìµœì¢… í›„ë³´ë¥¼ ì„ ì •í•˜ê¸° ìœ„í•´, **(ê²½ìš°ì— ë”°ë¼ Pre-train ëœ) Image Classifier $F$ ì˜ ì¶œë ¥ê°’ì— ê°€ì¥ ë§ì´ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ë²¡í„°** ë¥¼ ì°¾ëŠ”ë‹¤.

![image](../images/StyleGANVectorFind_3.PNG)

[(ì¶œì²˜)](https://arxiv.org/pdf/2012.09036) : Ceyuan Yang, Yujun Shen et al., "Semantic Hierarchy Emerges in Deep Generative Representations for Scene Synthesis"

**2. Label ë²¡í„° ê³„ì‚° ìƒì„¸**

* ë‹¤ìŒê³¼ ê°™ì´, Decision Boundary ë²¡í„°ì™€ ìˆ˜ì§ì¸ ê° ë²¡í„° $n_i$ ì— ëŒ€í•´ **Image Classifier $F$ ì˜ ì¶œë ¥ê°’ì˜ ë³€í™” ì •ë„ $CHANGE$** ì— ëŒ€í•œ **ëª¨ë“  sample ì— ëŒ€í•œ í‰ê· ê°’ $âˆ†s_i$** ë¥¼ ê³„ì‚°í•œë‹¤.
  * ìµœì¢… ì„ ì • ë²¡í„°ëŠ” **$âˆ†s_i$ ì˜ ê°’ì´ ê°€ì¥ í° $n_i$** ì´ë‹¤.
  * ì´ë•Œ, ëª¨ë“  í›„ë³´ ë²¡í„° $n$ ì€ **fixed norm = 1 ë¡œ ì •ê·œí™”** ëœë‹¤.
* ìˆ˜ì‹
  * $\displaystyle âˆ†s_i = \frac{1}{K} \Sigma_{k=1}^K max(CHANGE_k, 0)$ 
  * $CHANGE_k = F_i(G(z^k + \lambda n_i)) - F_i(G(z^k))$
* ìˆ˜ì‹ ì„¤ëª…
  * $K$ : ì „ì²´ ìƒ˜í”Œ ê°œìˆ˜
  * $n_i$ : Decision Boundary ì™€ ìˆ˜ì§ì¸ ê° ë²¡í„° $n$, ì¦‰ ìµœì¢… ë²¡í„° í›„ë³´ 
  * $\lambda$ : Fixed moving step

### 2-3. í•´ë‹¹ Vector ë¥¼ ì´ìš©í•œ Label ê°’ ë³€ê²½

ìµœì¢…ì ìœ¼ë¡œ ì±„íƒí•œ ë²¡í„° $n$ ì„ ì´ìš©í•˜ì—¬ **ì´ë¯¸ì§€ì˜ Label (Condition) ì— í•´ë‹¹í•˜ëŠ” ë¶€ë¶„ë§Œ ë³€ê²½** í•  ë•Œ, ë‹¤ìŒê³¼ ê°™ì€ 3ê°€ì§€ ë°©ë²•ì´ ì‚¬ìš©ëœë‹¤.

| ë°©ë²•                           | ì„¤ëª…                                                                                                                                          |
|------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|
| **Independent** Manipulation | - $z$ ëŒ€ì‹  $z + \lambda n$ ì„ latent code ë¡œ ì´ìš©í•˜ì—¬ ì´ë¯¸ì§€ ìƒì„±                                                                                        |
| **Joint** Manipulation       | - ì—¬ëŸ¬ ê°œì˜ variation factor (ì˜ˆ: $n_1$, $n_2$) ë¥¼ Joint í•˜ê²Œ ì ìš©<br>- ì¦‰ $z$ ëŒ€ì‹  $z + \lambda_1 n_1 + \lambda_2 n_2$ ë¥¼ latent code ë¡œ ì´ìš©í•˜ì—¬ ì´ë¯¸ì§€ ìƒì„±      |
| **Jittering** Manipulation   | - Independent Manipulation + **Random Noise** ì˜ ì•„ì´ë””ì–´<br>- $z$ ëŒ€ì‹  $z + \lambda n + \delta (\delta \sim N(0, 1))$ ì„ latent code ë¡œ ì´ìš©í•˜ì—¬ ì´ë¯¸ì§€ ìƒì„± |

![image](../images/StyleGANVectorFind_4.PNG)

[(ì¶œì²˜)](https://arxiv.org/pdf/2012.09036) : Ceyuan Yang, Yujun Shen et al., "Semantic Hierarchy Emerges in Deep Generative Representations for Scene Synthesis"

## 3. ì‹¤í—˜ ì„¤ì • ë° ê²°ê³¼

### 3-1. ì‹¤í—˜ ì„¤ì •

### 3-2. ì‹¤í—˜ ê²°ê³¼