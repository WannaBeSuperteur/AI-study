## 목차

* [1. 핵심 아이디어](#1-핵심-아이디어)
* [2. StyleGAN 의 구조](#2-stylegan-의-구조)
  * [2-1. Mapping Network](#2-1-mapping-network) 
  * [2-2. Synthesis Network](#2-2-synthesis-network)
  * [2-3. AdaIN Operation](#2-3-adain-operation)
* [3. StyleGAN 의 특징](#3-stylegan-의-특징)
  * [3-1. Style Mixing](#3-1-style-mixing)
  * [3-2. Stochastic variation](#3-2-stochastic-variation)
  * [3-3. Global Effects 와 Stochasticity 의 분리](#3-3-global-effects-와-stochasticity-의-분리)
* [4. 실험 결과](#4-실험-결과)

## 논문 소개

* Tero Karras and Samuli Laine et al., "A Style-Based Generator Architecture for Generative Adversarial Networks", 2018
* [arXiv Link](https://arxiv.org/pdf/1812.04948)

## 1. 핵심 아이디어

* [GAN (Generative Adversarial Network)](../../Generative%20AI/Basics_GAN.md) 의 Generator 에서 이미지를 합성할 때, **Generator 의 각 Conv. Layer 에서 이미지의 '스타일'을 조정** 한다.
  * 이를 통해 **서로 다른 scale 의 feature 들의 강도를 직접 제어** 한다.
  * 신경망에 추가되는 noise 와 합성되어, **high-level 속성 (얼굴 표정 등) 들을 stochastic variation (머리카락 등) 과 분리** 한다.
* 이때, Discriminator, Loss Function 등은 기존의 GAN 에서 수정하지 않는다.

## 2. StyleGAN 의 구조

![image](../images/Vision_StyleGAN_1.PNG)

[(출처)](https://arxiv.org/pdf/1812.04948) : Tero Karras and Samuli Laine et al., "A Style-Based Generator Architecture for Generative Adversarial Networks"

StyleGAN 은 위와 같이 **Style-Based Generator** 를 이용한다. 그 구조는 다음과 같다.

| 구조                                        | 설명                                                                                                                                                                                                                                    |
|-------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Mapping Network                           | input latent vector $z \in Z$ 로부터 intermediate latent vector $w \in W$ 를 생성                                                                                                                                                           |
| Synthesis Network                         | intermediate latent vector $w \in W$ 로부터 Upsampling 을 통해 이미지 생성                                                                                                                                                                       |
| AdaIN Operation<br>(in Synthesis Network) | AdaIN = **Adaptive Instance Normalization**<br>- 'Style' 과 [Gaussian Normalization](../../AI%20Basics/Data%20Science%20Basics/데이터_사이언스_기초_Normalization.md#2-2-standarization-z-score-normalization) 을 통해 Generator 의 이미지 생성 프로세스를 조정 |

### 2-1. Mapping Network

Mapping Network 는 **Non-linear** 이며, **input latent vector $z \in Z$ 로부터 intermediate latent vector $w \in W$ 를 mapping (생성)** 한다.

* 총 8개의 Fully-Connected Layer 로 구성된다.

### 2-2. Synthesis Network

Synthesis Network 는 **intermediate latent vector $w \in W$ 로부터 이미지를 생성** 하는 신경망이다.

* 각 레이어는 다음과 같은 단계로 구성
  * Upsampling
  * (3 x 3 Conv. → scaling factor 가 적용된 **noise (B)** 추가 → **style (A)** 을 이용한 AdaIN Operation) 의 2회 반복
* 또한, feature map 에 noise input 을 추가하여 stochastic detail (머리카락 등) 을 생성한다.
  * 이 noise image 는 **모든 feature map 에 추가** 된다. 
* 총 18개의 레이어로 구성된다.

### 2-3. AdaIN Operation

Synthesis Network 에서 일어나는 **AdaIN (Adaptive Instance Normalization) Operation** 은 **Style 과 Gaussian Normalization 을 이용하여 이미지 생성 과정을 조정** 하는 역할을 한다.

* 수식
  * $\displaystyle AdaIN(x_i, y) = y_{s,i} \times \frac{x_i - \mu(x_i)}{\sigma(x_i)} + y_{b_i}$
* 수식 설명
  * $x_i$ : feature map
  * $y$ : style 을 나타내는 값 ($y_s$ : scaling factor, $y_b$ : bias)

## 3. StyleGAN 의 특징

### 3-1. Style Mixing

### 3-2. Stochastic variation

### 3-3. Global Effects 와 Stochasticity 의 분리

## 4. 실험 결과

