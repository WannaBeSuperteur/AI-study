## 목차

* [1. 핵심 아이디어](#1-핵심-아이디어)
* [2. Normal, GAS, LAS branch](#2-normal-gas-las-branch)
  * [2-1. Normal branch](#2-1-normal-branch)
  * [2-2. GAS branch](#2-2-gas-branch)
  * [2-3. LAS branch](#2-3-las-branch)
* [3. Feature Extractor & Adaptor](#3-feature-extractor--adaptor)
* [4. Global Anomaly Synthesis](#4-global-anomaly-synthesis)
  * [4-1. Normal Feature Point 의 분포](#4-1-normal-feature-point-의-분포) 
  * [4-2. Truncated Projection (Manifold)](#4-2-truncated-projection-manifold)
  * [4-3. Truncated Projection (Hypersphere)](#4-3-truncated-projection-hypersphere)
* [5. Local Anomaly Synthesis (Image-Level)](#5-local-anomaly-synthesis-image-level)
* [6. Loss Function](#6-loss-function)
* [7. Inference & Anomaly Scoring](#7-inference--anomaly-scoring)
* [8. 실험 설정 및 결과](#8-실험-설정-및-결과)
  * [8-1. 실험 설정 및 성능지표](#8-1-실험-설정-및-성능지표)
  * [8-2. 실험 결과](#8-2-실험-결과)

## 논문 소개

* Qiyu Chen and Huiyuan Luo et al., "A Unified Anomaly Synthesis Strategy with Gradient Ascent for Industrial Anomaly Detection and Localization", 2024
* [Arxiv Link](https://arxiv.org/pdf/2407.09359v1)

## 1. 핵심 아이디어

GLASS 의 전체 구조 및 핵심 아이디어는 다음과 같다.

![image](../images/Vision_GLASS_1.PNG)

[(출처)](https://arxiv.org/pdf/2407.09359v1) : Qiyu Chen and Huiyuan Luo et al., "A Unified Anomaly Synthesis Strategy with Gradient Ascent for Industrial Anomaly Detection and Localization"

* 학습 과정
  * **Normal / Local Anomaly / Global Anomaly Feature** 추출
    * 먼저 **Normal Image** 를 Feature Adaptor 에 입력시켜 **normal feature 를 추출** 한다. (Normal Branch)
    * 그 다음으로, Adapted Normal Feature 를 입력받은 GAS branch 의 gradient guidance 를 통해, **Global Anomaly Feature 를 추출** 한다.
    * 한편, 원본 이미지로부터 생성된 Local Anomaly 가 있는 이미지의 **Local Anomaly Feature** 를 LAS branch 를 통해 추출한다.
  * 이들 3개의 feature 는 **Discriminator 로 입력되고, 이를 통해 Normal / Abnormal 여부를 판정** 한다.

* 참고 사항
  * **학습 과정에서는 Normal Image 만 입력** 된다. (다른 Anomaly Detection 모델들처럼)
  * 본 모델은 Test (inference) 단계에서는 **Normal Branch** 만이 사용된다.
  * 각 branch 는 **Feature Extractor, Feature Adaptor, Discriminator 를 공유** 한다.
    * 즉 각 branch 별로 이들 프로세스가 있는 것이 아니라, 전체 모델에서 **Feature Extractor, Feature Adaptor, Discriminator 는 각각 1개씩** 이다.

* 각 구성 요소의 학습 가능 여부

| Feature Extractor | Feature Adaptor | Discriminator |
|-------------------|-----------------|---------------|
| Frozen            | Trainable       | Trainable     |

## 2. Normal, GAS, LAS branch

각 branch 에 대한 기본 사항은 다음과 같다.

| Branch                                | 입력 이미지                                                 | Discriminator 에 입력되는 Feature                                                  | 포함 Process                                                                    |
|---------------------------------------|--------------------------------------------------------|-------------------------------------------------------------------------------|-------------------------------------------------------------------------------|
| Normal Branch                         | **Normal 이미지**                                         | Feature Adaptor 처리된 **Adapted Normal Feature**                                | - Feature Extractor<br>- Feature Adaptor<br>- Discriminator                   |
| GAS (Global Anomaly Synthesis) Branch | Adapted Normal Feature + Gaussian Anomaly 추가된 Feature  | Gaussian Anomaly Feature 가 추가 처리된 **Global Anomaly Feature**                  | - **Gaussian Noise + Gradient Ascent + Truncated Project**<br>- Discriminator |
| LAS (Local Anomaly Synthesis) Branch  | Normal 이미지에 임의로 Anomaly 를 추가한 **Locally Abnormal 이미지** | Local Anomaly Feature 가 Feature Adaptor 처리된 **Adapted Local Anomaly Feature** | - Feature Extractor<br>- Feature Adaptor<br>- Discriminator                   |

* GAS 에서의 Gaussian Anomaly 는 **현실의 Anomaly 를 시뮬레이션** 하기 위해 사용된다.
* GAS 에서 사용되는 것과 같은 Gradient Ascent 는 **Anomaly 를 Synthesize 하는 가장 효과적인 방법** 중 하나이다.
* Truncated Projection 은 **Abnomral feature 가 Normal feature 가 매우 가깝거나 멀게 되는 것을 방지** 하는 방법이다.

## 3. Feature Extractor & Adaptor

**Feature Extractor** 와 **Feature Adaptor** 의 역할은 다음과 같다.

| 구성 요소             | 학습 가능 여부  | 역할                                                                                                |
|-------------------|-----------|---------------------------------------------------------------------------------------------------|
| Feature Extractor | Frozen    | input image 의 feature 를 **여러 level 에서 각각 추출 후, 이를 Upsampling & Concatenate** 하여 Normal Feature 추출 |
| Feature Adaptor   | Trainable | 추가 학습 불가능한 (frozen) Feature Extractor 로부터 추출된 feature 에 대한 **Latent Domain Bias** 를 줄인다.          |

![image](../images/Vision_GLASS_2.PNG)

[(input image 출처)](https://arxiv.org/pdf/2407.09359v1) : Qiyu Chen and Huiyuan Luo et al., "A Unified Anomaly Synthesis Strategy with Gradient Ascent for Industrial Anomaly Detection and Localization"

## 4. Global Anomaly Synthesis

### 4-1. Normal Feature Point 의 분포

### 4-2. Truncated Projection (Manifold)

### 4-3. Truncated Projection (Hypersphere)

## 5. Local Anomaly Synthesis (Image-Level)

## 6. Loss Function

## 7. Inference & Anomaly Scoring

## 8. 실험 설정 및 결과

### 8-1. 실험 설정 및 성능지표

### 8-2. 실험 결과