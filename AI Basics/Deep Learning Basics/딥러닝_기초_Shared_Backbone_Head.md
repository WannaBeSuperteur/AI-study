
## 목차

* [1. Shared Backbone & Shared Head 개요](#1-shared-backbone--shared-head-개요)
* [2. 구조 비교](#2-구조-비교)
* [3. 탐구: 어떤 구조가 가장 좋을까?](#3-탐구-어떤-구조가-가장-좋을까)
  * [3-1. 실험 설계](#3-1-실험-설계)
  * [3-2. 실험 결과](#3-2-실험-결과)
  * [3-3. 실험 결과에 대한 이유 분석](#3-3-실험-결과에-대한-이유-분석)

## 1. Shared Backbone & Shared Head 개요

딥러닝 모델의 구조에서 **Shared Backbone** 과 **Shared Head** 는 각각 다음을 의미한다.

| 용어              | 설명                                         |
|-----------------|--------------------------------------------|
| Shared Backbone | 모델 학습 시 **여러 task 에 대해 backbone을 공유** 하는 것 |
| Shared Head     | 모델 학습 시 **여러 개의 분류/회귀 head를 공유** 하는 것      |

본 문서에서는 Shared Backbone, Shared Head 가 아닌 경우를 각각 **Splitted Backbone, Splitted Head** 로 칭한다.

## 2. 구조 비교

딥러닝 모델은 Shared Backbone & Shared Head 각각의 적용 여부에 따라 다음과 같이 5가지 구조로 나눌 수 있다.

![image](images/Backbone_Head_1.PNG)

| 구조    | Shared Backbone | Shared Head | 기타 특징              |
|-------|-----------------|-------------|--------------------|
| (1)   | X               | O           |                    |
| (2)   | O               | O           |                    |
| (3)   | O               | X           |                    |
| (4)-1 | X               | X           | MLP 부분 공유          |
| (4)-2 | X               | X           | 개별 모델, MLP 부분 비 공유 |

## 3. 탐구: 어떤 구조가 가장 좋을까?

### 3-1. 실험 설계

* 실험 개요
  * 위 5가지 구조 중 **가장 좋은 구조가 무엇인지** 를 **성능 & inference time** 기준으로 측정 
* task
  * MNIST Full Dataset 에서 **0, 1, 2 숫자 이미지 분류**
  * 위 5가지 구조 이미지에 나타난 분류 기준 (예: ```0,1 vs. 2```) 을 그대로 적용
* 실험 대상 모델

| 구분       | 설명                                           |
|----------|----------------------------------------------|
| backbone | ```ResNet18``` ```ResNet34``` ```ResNet50``` |
| 모델 구조    | 위 5가지 구조 각각 실험                               |

* 정확도 판정 방식

| 구조    | Shared Backbone | Shared Head | 정확도 판정 방식 (실험 1)                | 정확도 판정 방식 (실험 2)           |
|-------|-----------------|-------------|---------------------------------|----------------------------|
| (1)   | X               | O           | Head 의 3가지 Class 의 단순 예측 정확도    | 좌동                         |
| (2)   | O               | O           | Head 의 3가지 Class 의 단순 예측 정확도    | 좌동                         |
| (3)   | O               | X           | 각 Head 의 2가지 Class 의 예측 정확도의 평균 | 2개의 Head 모두 정확히 예측해야 정답 처리 |
| (4)-1 | X               | X           | 각 Head 의 2가지 Class 의 예측 정확도의 평균 | 2개의 Head 모두 정확히 예측해야 정답 처리 |
| (4)-2 | X               | X           | 각 Head 의 2가지 Class 의 예측 정확도의 평균 | 2개의 Head 모두 정확히 예측해야 정답 처리 |

### 3-2. 실험 결과

* **실험 결과 요약**
  * TBU 

* **실험 1 결과**
  * **Splitted Head** 인 **(3), (4)-1, (4)-2** 의 경우, **각 Head의 2가지 Class의 예측 정확도 평균** 사용

| 구분    | 실험 결과                                | 결과 요약                                                                                                               |
|-------|--------------------------------------|---------------------------------------------------------------------------------------------------------------------|
| 정확도   | ![image](images/Backbone_Head_2.PNG) | - **Splitted Backbone** 이 Shared backbone 보다 정확도 **소폭 높음**<br>- **Splitted Head** 가 Shared Head 보다 정확도 **높음**       |
| 추론 시간 | ![image](images/Backbone_Head_3.PNG) | - **Shared Backbone** 이 Splitted Backbone 보다 **추론 시간이 절반 수준으로, 속도가 빠름**<br>- backbone 모델 크기가 커질수록 추론 시간이 이에 비례하여 증가 |

* **실험 2 결과**
  * **Splitted Head** 인 **(3), (4)-1, (4)-2** 의 경우, **2개의 Head 모두 정확히 예측해야 정답 처리되는 정확도** 사용

### 3-3. 실험 결과에 대한 이유 분석

* TBU
