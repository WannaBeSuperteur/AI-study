# Image Processing 프로젝트 2. MNIST 이미지 해상도 늘리기
* Dataset: [MNIST DataSet](https://www.kaggle.com/datasets/oddrationale/mnist-in-csv/data)
  * 위 주소에서 다운로드 받은 ```mnist_train.csv``` 파일이 학습 데이터, ```mnist_test.csv``` 파일이 테스트 데이터이다.
* 수행 기간: 2024.03.07 ~ 2024.03.10 (4일)

## 파일 및 코드 설명
* ```mnist_train.csv``` : 학습 데이터셋
* ```mnist_test.csv``` : 테스트 데이터셋
* ```train.py``` : 데이터 전처리를 포함한 학습 과정 전체 진행
  * 필요 파일 : ```mnist_train.csv``` (학습 데이터셋)
  * 출력 모델 : ```main_model``` (이미지 중앙 + 모양 부분 예측 모델)
* ```test.py``` : 이미지 생성
  * 필요 파일 : ```mnist_test.csv``` (테스트 데이터셋)
  * 필요 모델 : ```main_model```
  * 출력 파일 : ```test_outputs/test_output_{N}.png```, ```N``` = 0, 1, ..., (테스트 데이터 개수) - 1

## 데이터 전처리 및 생성 과정
* ```minst_train.csv``` 파일의 각 행에서 image 부분 (784 = 28 x 28) 을 추출
* image 부분에 대해 다음과 같이 4 쌍의 input, output 데이터 생성 (```(y,x)``` 는 이미지 내부 픽셀의 ```y```, ```x``` 좌표 쌍으로, ```(0,0)``` 부터 ```(27,27)``` 까지 존재)

|input|output|
|---|---|
|```(0,0)```, ```(0,2)```, ```(0,4)```, ```(26,26)``` 의 196개 픽셀|```(12,13)```, ```(13,12)```, ```(13,13)```, ```(13,14)```, ```(14,13)``` 의 5개 픽셀|
|```(1,0)```, ```(1,2)```, ```(1,4)```, ```(27,26)``` 의 196개 픽셀|```(13,13)```, ```(14,12)```, ```(14,13)```, ```(14,14)```, ```(15,13)``` 의 5개 픽셀|
|```(0,1)```, ```(0,3)```, ```(0,5)```, ```(26,27)``` 의 196개 픽셀|```(12,14)```, ```(13,13)```, ```(13,14)```, ```(13,15)```, ```(14,14)``` 의 5개 픽셀|
|```(1,1)```, ```(1,3)```, ```(1,5)```, ```(27,27)``` 의 196개 픽셀|```(13,14)```, ```(14,13)```, ```(14,14)```, ```(14,15)```, ```(15,14)``` 의 5개 픽셀|

## 머신러닝 모델 설명
* input 을 14 x 14 2D 이미지 형태로 만들어서 CNN 구조를 이용하여 학습
  * 이때, 5개의 output에 모두에 대해서 공통인 CNN 구조와, 해당 공통 CNN 구조에서 이어지는 총 5개 (각각의 output 마다 1개씩) 의 CNN 구조를 이용
    * 개별 output을 개별적으로 분리된 CNN 구조를 통해 예측 가능
  * 중심부에 있는 4개 픽셀에 대한 정보는 별도의 신경망을 이용하여 처리, 각각의 output 마다 개별적으로 존재하는 CNN 구조의 fully connected layer 부분과 연결
  * 그림 설명은 추후 추가 예정

## 실행 순서
```
python train.py
python test.py
```

## 성능지표 결과
* 성능 측정지표 : 정성 평가로 진행
  * ```test.py``` 파일 실행 시, 디코더 모델 (```cvae_decoder_model```) 에서 입력 Class를 받은 후, 모델이 출력하는 이미지 ```test_output.png``` 파일을 확인할 수 있음

## branch info
|branch|status|type|start|end|description|
|---|---|---|---|---|---|
|GAI-P2-master|||240307|240310|마스터 브랜치|
|GAI-P2-1|```feat```|||모델 학습 부분 구현|
|GAI-P2-2|```feat```|||모델 테스트 부분 구현|